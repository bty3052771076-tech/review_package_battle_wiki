# 任务书：Backpack Battles 中文 Wiki 本地复刻

## 阶段 0：确认与准备
- [x] 确认目标范围：全站主命名空间页面（以 Special:AllPages 为入口清单）
- [x] 确认不包含广告、社区功能、站外内容抓取
- [x] 选择抓取与渲染方案：优先使用 MediaWiki `?action=render` 获取净化 HTML，必要时回退 HTML 改写
- [x] 在工作区创建虚拟环境：`.venv`

## 阶段 1：内容发现与清单生成
- [x] 访问 Special:AllPages，分页抓取所有主命名空间链接（通过 `r.jina.ai` 转发 MediaWiki API）
- [x] 生成页面 URL 清单（去重、规范化）：`data/pages.txt`、`data/pages.json`
- [x] 记录站内结构与分类页入口（已在 `requirements.md` 与 `design.md` 记录）

## 阶段 2：页面抓取与本地化
- [x] 逐页获取内容（渲染结果）：脚本 `fetch_pages.py` 已就绪，待全量运行
- [x] 过滤广告链接与广告区域：脚本内已实现过滤规则
- [x] 下载并本地化图片资源：脚本内已实现下载与本地化
- [x] 重写站内链接为本地路径：脚本内已实现链接改写

## 阶段 3：静态站点生成
- [x] 生成页面 HTML（统一模板/页头页脚）
- [x] 输出到 `site/` 目录
- [x] 生成首页与索引页（所有页面、分类等）

## 阶段 4：离线搜索
- [x] 抽取标题 + 摘要/正文文本
- [x] 生成 `search/index.json`
- [x] 集成前端搜索脚本并验证效果

## 阶段 5：验收与交付
- [x] 抽样页面对比：首页、物品、合成配方、角色、版本历史
- [x] 检查站内链接可达性与图片完整性
- [x] 检查许可信息可见
- [x] 输出使用说明（如何本地打开/更新）

## 交付物
- `requirements.md`
- `design.md`
- `tasks.md`
- （后续）`site/` 静态站点目录与抓取脚本
